<!DOCTYPE html>
<html lang="de">



<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Draft Board â€“ FantasyBlitz</title>
  <link rel="stylesheet" href="css/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<script>
  (function () {
    // ğŸ‘‰ spÃ¤ter echte Live-Domains hier eintragen, z.B.: ['fantasyblitz.ch','www.fantasyblitz.ch']
    var PROD_HOSTS = []; 
    if (!PROD_HOSTS.includes(location.hostname)) return; // lokal/preview -> kein Tracking

    var s = document.createElement('script');
    s.defer = true;
    s.src = 'https://static.cloudflareinsights.com/beacon.min.js';
    s.setAttribute('data-cf-beacon', '{"token":"DEIN_TOKEN"}'); // ğŸ‘‰ spÃ¤ter ersetzen
    document.head.appendChild(s);
  })();
</script>

</head>
<body>
  <header>
      <div class="logo-container">
        <a href="index.html">
          <img src="img/fantasyblitz-logo.png" alt="FantasyBlitz Logo" class="logo-img" />
        </a>
      </div>
    <nav>
      <a href="index.html">Startseite</a> |
      <a href="rankings.html">Weekly Rankings</a> |
      <a href="waivers.html">Waivers</a> |
      <div class="dropdown">
        <a href="#">Draft</a>
        <div class="dropdown-content">
          <a href="draft-2025.html">Draft Cheat Sheet</a>
          <a href="draft-guide.html">Draft Guide</a>
        </div>
      </div> |
      <a href="stats.html">Stats</a> |
      <a href="info.html">Info</a>
    </nav>
  </header>

  <main class="draft-page">
    <h2>Draft Board</h2>
     <p class="intro-text">
      Ziehe und sortiere die Spieler <b>ausschlieÃŸlich in der Liste â€Alle Positionen"</b>,
      um deine gewÃ¼nschte Draft-Reihenfolge festzulegen.
      Ã„nderungen dort aktualisieren automatisch die Positionslisten.
    </p>

    <a href="draft-2025.html" class="btn-dark">â‡¦ ZurÃ¼ck zum FantasyBlitz Draft Ranking 2025</a>
    <!-- Toolbar rechts -->
    <div class="draft-toolbar">
      <button id="togglePosColors" class="btn-toggle" type="button" aria-pressed="false">
        Positionsfarben ausblenden
      </button>
    </div>

    <div id="rankingsContainer" class="rankings-grid"></div>
  </main>

<footer class="site-footer" role="contentinfo">
  <p>
    Â© <span id="y">2025</span> FantasyBlitz Â·
    <a class="footer-link" href="impressum.html">Impressum</a> Â·
    <a class="footer-link" href="datenschutz.html">Datenschutz</a>
  </p>
</footer>

<script>
  // Jahr automatisch: "2025" oder "2025â€“{aktuelles Jahr}"
  (function(){
    var start=2025, y=new Date().getFullYear();
    var el=document.getElementById('y'); if(el) el.textContent = y>start ? (start + 'â€“' + y) : String(start);
  })();
</script>



  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const container = document.getElementById('rankingsContainer');

      // === Positionsfarben Toggle ===
      const toggleBtn = document.getElementById('togglePosColors');
      function applyPosColorsState(off){
        document.body.classList.toggle('no-pos-colors', off);
        toggleBtn.textContent = off ? 'Positionsfarben anzeigen' : 'Positionsfarben ausblenden';
        toggleBtn.setAttribute('aria-pressed', String(off));
        localStorage.setItem('posColors', off ? 'off' : 'on');
      }
      const saved = localStorage.getItem('posColors');
      applyPosColorsState(saved === 'off');
      toggleBtn.addEventListener('click', () => {
        const willOff = !document.body.classList.contains('no-pos-colors');
        applyPosColorsState(willOff);
      });

      // === Daten laden ===
      // ==== Pfade zu deinen JSONs ====
      const BASE_JSON_PATH = 'data/draft/2025/draft-rankings-2025.json';      // ALL, QB, RB, WR, TE
      const DEF_JSON_PATH  = 'data/draft/2025/draft-rankings-2025-def.json';  // NUR Defenses
      const K_JSON_PATH    = 'data/draft/2025/draft-rankings-2025-k.json';    // NUR Kicker
      let draftData = [];
      let defData = [];
      let kickerData = [];

      try {
        const [baseRes, defRes, kRes] = await Promise.all([
          fetch(BASE_JSON_PATH, { cache: 'no-store' }),
          fetch(DEF_JSON_PATH,  { cache: 'no-store' }),
          fetch(K_JSON_PATH,    { cache: 'no-store' }),
        ]);
        if (!baseRes.ok) throw new Error('Fehler beim Laden der Basis-Daten');
        draftData = await baseRes.json();
        if (defRes.ok)   defData    = await defRes.json();   
        if (kRes.ok)     kickerData = await kRes.json();
      } catch (e) {
        console.error('Fehler beim Laden:', e);
      }

      // Spalten anlegen (ALL + Skill-Pos)
      const positions = ['ALL', 'QB', 'RB', 'WR', 'TE'];
      const positionLists = {};

      positions.forEach(pos => {
        const column = document.createElement('div');
        column.className = 'position-column';

        const title = document.createElement('h3');
        title.textContent = (pos === 'ALL') ? 'Alle Positionen' : pos;
        column.appendChild(title);

        const list = document.createElement('div');
        list.id = 'list-' + pos;
        list.className = 'player-list';
        column.appendChild(list);

        container.appendChild(column);
        positionLists[pos] = list;
      });

      // DEF-Spalte anlegen
      // Kombi-Spalte: DEF oben, Kicker darunter
      const dkCol = document.createElement('div');
      dkCol.className = 'position-column';

      // DEF
      {
        const h3 = document.createElement('h3');
        h3.textContent = 'DEF';
        dkCol.appendChild(h3);

        const list = document.createElement('div');
        list.id = 'list-DEF';
        list.className = 'player-list';
        dkCol.appendChild(list);
      }

      // Trennlinie
      const sep = document.createElement('hr');
      sep.style.border = 'none';
      sep.style.height = '1px';
      sep.style.background = '#ddd';
      sep.style.margin = '8px 0';
      dkCol.appendChild(sep);

      // Kicker
      {
        const h3 = document.createElement('h3');
        h3.textContent = 'Kicker';
        dkCol.appendChild(h3);

        const list = document.createElement('div');
        list.id = 'list-KICKER';
        list.className = 'player-list';
        dkCol.appendChild(list);
      }

      container.appendChild(dkCol);


      // ===== Rendering =====
      let currentData = draftData.slice();

      function renderPlayers(data) {
        // leeren
        positionLists['ALL'].innerHTML = '';
        ['QB', 'RB', 'WR', 'TE'].forEach(pos => positionLists[pos].innerHTML = '');
        // DEF/KICKER nicht jedes Mal neu anlegen â€“ nur Inhalt leeren:
        const defList = document.getElementById('list-DEF');
        const kList   = document.getElementById('list-KICKER');
        if (defList) defList.innerHTML = '';
        if (kList)   kList.innerHTML   = '';

        // Helper: sicherer Selektor ohne Backticks
        const safeSelForPlayer = (name) => {
          const safe = (window.CSS && CSS.escape) ? CSS.escape(name) : String(name).replace(/["\\]/g, "\\$&");
          return '.player-entry[data-player="' + safe + '"]';
        };

        // 1) "Alle Spieler" rendern und globale Rang-Map aufbauen
        const globalRank = new Map();
        data.forEach((player, index) => {
          const rank = index + 1;
          globalRank.set(player.player, rank);

          const playerDiv = document.createElement('div');
          playerDiv.className = 'player-entry ' + String(player.position).toUpperCase();
          playerDiv.dataset.player = player.player;
          playerDiv.dataset.position = player.position;
          playerDiv.textContent = rank + '. ' + player.player + ' (' + player.team + ', ' + player.position + ')';

          playerDiv.addEventListener('click', () => {
            document.querySelectorAll(safeSelForPlayer(player.player))
              .forEach(entry => entry.classList.toggle('crossed'));
          });

          positionLists['ALL'].appendChild(playerDiv);
        });

        // 2) Positionsspalten (QB/RB/WR/TE): gleiche Reihenfolge wie in ALL
        ['QB', 'RB', 'WR', 'TE'].forEach(pos => {
          const filtered = data.filter(p => String(p.position).toUpperCase() === pos);
          filtered.forEach((player) => {
            const overall = globalRank.get(player.player) || 0;
            const div = document.createElement('div');
            div.className = 'player-entry ' + String(player.position).toUpperCase();
            div.dataset.player = player.player;
            div.dataset.position = player.position;
            div.textContent = overall + '. ' + player.player + ' (' + player.team + ', ' + player.position + ')';

            div.addEventListener('click', () => {
              document.querySelectorAll(safeSelForPlayer(player.player))
                .forEach(entry => entry.classList.toggle('crossed'));
            });

            positionLists[pos].appendChild(div);
          });
        });

        // 3) DEF (eigene JSON, eigener Rang)
        if (defList && Array.isArray(defData)) {
          defData.forEach((player, i) => {
            const div = document.createElement('div');
            div.className = 'player-entry DEF';
            div.dataset.player = player.player;
            const rankText = (player.rank != null ? player.rank : (i + 1)) + '.';
            div.textContent = rankText + ' ' + player.player + ' (' + player.team + ', ' + (player.position || 'DEF') + ')';

            div.addEventListener('click', () => {
              document.querySelectorAll(safeSelForPlayer(player.player))
                .forEach(entry => entry.classList.toggle('crossed'));
            });

            defList.appendChild(div);
          });
        }

        // 4) Kicker (eigene JSON, eigener Rang)
        if (kList && Array.isArray(kickerData)) {
          kickerData.forEach((player, i) => {
            const div = document.createElement('div');
            div.className = 'player-entry Kicker';
            div.dataset.player = player.player;
            const rankText = (player.rank != null ? player.rank : (i + 1)) + '.';
            div.textContent = rankText + ' ' + player.player + ' (' + player.team + ', ' + (player.position || 'Kicker') + ')';

            div.addEventListener('click', () => {
              document.querySelectorAll(safeSelForPlayer(player.player))
                .forEach(entry => entry.classList.toggle('crossed'));
            });

            kList.appendChild(div);
          });
        }
      }

      renderPlayers(currentData);

      // Drag & Drop nur in "Alle Spieler"
      Sortable.create(positionLists['ALL'], {
        animation: 150,
        onEnd: () => {
          // neue Reihenfolge Ã¼bernehmen
          currentData = Array.from(positionLists['ALL'].children).map(div => {
            const name = div.dataset.player;
            return draftData.find(p => p.player === name);
          });
          renderPlayers(currentData);
        }
      });
    });
  </script>
</body>
</html>
